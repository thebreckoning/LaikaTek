<!DOCTYPE html>
<html lang="en">
<!-- Dashboard -->

<html>
    <head>
        {% include './head.html' %}
    </head>

    <body>

        {% include './header.html' %}
        <main>
            <div class="column-container">
                <div class="column">
                    {% if user %}
                    <div>
                        <h1 class="column-title">User Profile</h1>
                    </div>
                    <div class="profile">
                        <img
                            src="{{ user.profile_image if user.profile_image else url_for('static', filename='default_profile.png') }}"
                            alt="Profile Image">
                    </div>
                    <div class="content">
                        <h1>Hello, {{ user.username }}, {{user.user_id}}</h1>
                        <p>Email: {{ user.email_address }}</p>
                        <p>Phone Number: {{ user.phone_number }}</p>
                        <p>Street Address: {{ user.street_address }}</p>
                        <p>City: {{ user.city }}</p>
                        <p>State: {{ user.state }}</p>
                        <p>Zip Code: {{ user.zip_code }}</p>
                    </div>

                </div>

                <div class="pets-column">

                    <h1 class="column-title">Pets</h1>
                   <div class="info-container">
                    {% if pets %}
                        {% for pet in pets %}
                            <div class="info-box">
                                <div>
                                    <div class="item-profile-image">
                                        <img
                                        <img src="{{ pet.pet_profile_image if pet.pet_profile_image else url_for('static', filename='default_profile.png') }}" alt="Pet Profile Image">
                                            alt="Profile Image">
                                    </div>
                                </div>
                                <div>
                                    <p>
                                        <strong>Name:</strong> {{ pet.name }}<br>
                                        <strong>Breed:</strong> {{ pet.breed }}<br>
                                        <strong>Weight:</strong> {{ pet.weight }} lbs.<br>
                                        <a class="function-link" href="{{ url_for('edit_pet', pet_id=pet.pet_id) }}">Edit</a>
                                        <form action="{{ url_for('delete_pet', pet_id=pet.pet_id) }}" method="post" style="display: inline;">
                                            <input type="submit" value="Delete" onclick="return confirm('Are you sure you want to delete this device?');">
                                        </form>
                                    </p> 
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                        <p>You don't have any pets yet!!!</p>
                        {% endif %}
                    </div>
                    <div>
                        <a class="function-link" href="/add_pet" class="button">Add Pet</a>
                    </div>
                </div>
                <div class="devices-column">
                    <h1 class="column-title">Devices</h1>
                    <div class="info-container">
                        {% if devices %}
                            {% for device in devices %}
                                <div class="info-box">
                                    <div>
                                        <div class="item-profile-image">
                                            <img
                                                src="{{ user.profile_image if user.profile_image else url_for('static', filename='default_profile.png') }}"
                                                alt="Profile Image">
                                        </div>
                                    </div>
                                    <div>
                                        <p>
                                            <strong>Nickname:</strong> {{ device.nickname }}<br>
                                            <strong>Device Type:</strong> {{ device.type }}<br>
                                            <strong>Feed Times:</strong>
                                                <ul>
                                                {% for feed_time in device.feed_times %}
                                                    <li>{{ feed_time.time.strftime('%H:%M') }}</li>
                                                {% endfor %}
                                                </ul>
                                            <a class="function-link" href="{{ url_for('add_feed_time', device_id=device.device_id) }}">Add Feed Time</a>
                                            <a class="function-link" href="{{ url_for('edit_device', device_id=device.device_id) }}">Edit</a>
                                            <form action="{{ url_for('delete_device', device_id=device.device_id) }}" method="post" style="display: inline;">
                                                <input type="submit" value="Delete" onclick="return confirm('Are you sure you want to delete this device?');">
                                            </form>
                                        </p> 
                                    </div>
                                </div>
                                {% endfor %}
                            {% else %}
                            <p>You don't have any devices yet!</p>
                            {% endif %}
                        </div>
                        <div>
                            <a class="function-link" href="/add_device" class="button">Add Device</a>
                        </div>
                </div>
            </div>

            </div>

            <!-- <div class="device-profile-container">
                <h1>Hello, {{ user.username }}</h1>
            </div> -->

            {% else %}
            <p>You are not logged in. Please <a href="{{ url_for('login') }}">login</a>
                to view your account details.</p>
            {% endif %}
        </main>
    </body>
</html>
